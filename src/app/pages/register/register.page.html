<ion-content [fullscreen]="true" class="register-content">
  <div class="page-container">
    <div class="register-container">
      <!-- Header personalizado -->
      <div class="register-header">
        <div class="brand-section">
          <div class="logo-icon">
            <ion-icon name="cube-outline"></ion-icon>
          </div>
          <div class="brand-name">STOCKMASTER</div>
          <div class="brand-tagline">Gestión Inteligente de Inventario ✨</div>
        </div>
        
        <div class="welcome-text">
          <h1>¡Crear Nueva Cuenta!</h1>
          <p>Completa tus datos para unirte</p>
        </div>
      </div>

      <!-- Register Form -->
      <form [formGroup]="registerForm" (ngSubmit)="register()" class="register-form">
        <!-- Nombre completo -->
        <div class="form-group">
          <div class="input-container">
            <ion-icon name="person-outline" class="input-icon"></ion-icon>
            <input 
              type="text" 
              class="form-input" 
              placeholder="Nombre completo"
              formControlName="fullName"
              [class.error]="registerForm.get('fullName')?.invalid && registerForm.get('fullName')?.touched">
          </div>
          <div class="error-message" *ngIf="registerForm.get('fullName')?.invalid && registerForm.get('fullName')?.touched">
            <span *ngIf="registerForm.get('fullName')?.errors?.['required']">El nombre es requerido</span>
            <span *ngIf="registerForm.get('fullName')?.errors?.['minlength']">Mínimo 2 caracteres</span>
          </div>
        </div>

        <!-- Usuario -->
        <div class="form-group">
          <div class="input-container">
            <ion-icon name="at-outline" class="input-icon"></ion-icon>
            <input 
              type="text" 
              class="form-input" 
              placeholder="Nombre de usuario"
              formControlName="username"
              [class.error]="registerForm.get('username')?.invalid && registerForm.get('username')?.touched">
          </div>
          <div class="error-message" *ngIf="registerForm.get('username')?.invalid && registerForm.get('username')?.touched">
            <span *ngIf="registerForm.get('username')?.errors?.['required']">El usuario es requerido</span>
            <span *ngIf="registerForm.get('username')?.errors?.['minlength']">Mínimo 3 caracteres</span>
            <span *ngIf="registerForm.get('username')?.errors?.['userExists']">Este usuario ya existe</span>
          </div>
        </div>

        <!-- Email -->
        <div class="form-group">
          <div class="input-container">
            <ion-icon name="mail-outline" class="input-icon"></ion-icon>
            <input 
              type="email" 
              class="form-input" 
              placeholder="Correo electrónico"
              formControlName="email"
              [class.error]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
          </div>
          <div class="error-message" *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
            <span *ngIf="registerForm.get('email')?.errors?.['required']">El email es requerido</span>
            <span *ngIf="registerForm.get('email')?.errors?.['email']">Email inválido</span>
          </div>
        </div>

        <!-- Contraseña -->
        <div class="form-group">
          <div class="input-container password-container">
            <ion-icon name="lock-closed-outline" class="input-icon"></ion-icon>
            <input 
              [type]="showPassword ? 'text' : 'password'"
              class="form-input password-input" 
              placeholder="Contraseña"
              formControlName="password"
              [class.error]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
            <button type="button" class="password-toggle-btn" (click)="togglePasswordVisibility()">
              <ion-icon [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"></ion-icon>
            </button>
          </div>
          <div class="error-message" *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
            <span *ngIf="registerForm.get('password')?.errors?.['required']">La contraseña es requerida</span>
            <span *ngIf="registerForm.get('password')?.errors?.['minlength']">Mínimo 6 caracteres</span>
          </div>
        </div>

        <!-- Confirmar contraseña -->
        <div class="form-group">
          <div class="input-container password-container">
            <ion-icon name="lock-closed-outline" class="input-icon"></ion-icon>
            <input 
              [type]="showConfirmPassword ? 'text' : 'password'"
              class="form-input password-input" 
              placeholder="Confirmar contraseña"
              formControlName="confirmPassword"
              [class.error]="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
            <button type="button" class="password-toggle-btn" (click)="toggleConfirmPasswordVisibility()">
              <ion-icon [name]="showConfirmPassword ? 'eye-off-outline' : 'eye-outline'"></ion-icon>
            </button>
          </div>
          <div class="error-message" *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
            <span *ngIf="registerForm.get('confirmPassword')?.errors?.['required']">Confirma tu contraseña</span>
            <span *ngIf="registerForm.get('confirmPassword')?.errors?.['passwordMismatch']">Las contraseñas no coinciden</span>
          </div>
        </div>

        <button 
          type="submit" 
          class="register-button" 
          [disabled]="!registerForm.valid || isLoading">
          <span *ngIf="!isLoading">Crear Cuenta</span>
          <ion-spinner *ngIf="isLoading" name="crescent" color="light"></ion-spinner>
        </button>
      </form>

      <!-- Auth Links -->
      <div class="auth-links">
        <div class="divider">
          <span>¿Ya tienes cuenta?</span>
        </div>
        <a routerLink="/login" class="login-link">
          <span class="login-text">Iniciar Sesión</span>
        </a>
      </div>
    </div>
  </div>
</ion-content>